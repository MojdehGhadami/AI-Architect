{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "AIArchitectFinalResponse",
    "type": "object",
    "additionalProperties": false,
    "required": [
        "ready_to_answer",
        "blocked_reason",
        "assumptions",
        "gpu_recommendations",
        "model_recommendations",
        "k8s_components",
        "architecture_diagram_mermaid",
        "deployment_plan",
        "cost_estimate"
    ],
    "properties": {
        "ready_to_answer": {
            "type": "boolean"
        },
        "blocked_reason": {
            "type": [
                "string",
                "null"
            ]
        },
        "assumptions": {
            "type": "array",
            "minItems": 0,
            "items": {
                "type": "string"
            }
        },
        "gpu_recommendations": {
            "type": "array",
            "maxItems": 5,
            "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                    "label",
                    "provider",
                    "instance_type",
                    "gpu_type",
                    "gpu_count",
                    "vram_gb",
                    "price_per_hour",
                    "why",
                    "fallbacks"
                ],
                "properties": {
                    "label": {
                        "type": "string"
                    },
                    "provider": {
                        "type": "string"
                    },
                    "instance_type": {
                        "type": "string"
                    },
                    "gpu_type": {
                        "type": "string"
                    },
                    "gpu_count": {
                        "type": "integer",
                        "minimum": 1
                    },
                    "vram_gb": {
                        "type": "number",
                        "minimum": 1
                    },
                    "price_per_hour": {
                        "type": [
                            "number",
                            "null"
                        ]
                    },
                    "why": {
                        "type": "string",
                        "minLength": 10
                    },
                    "fallbacks": {
                        "type": "array",
                        "minItems": 1,
                        "items": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "model_recommendations": {
            "type": "array",
            "maxItems": 5,
            "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                    "model_id",
                    "task",
                    "license",
                    "params_billion",
                    "min_vram_gb",
                    "notes"
                ],
                "properties": {
                    "model_id": {
                        "type": "string",
                        "minLength": 2
                    },
                    "task": {
                        "type": "string",
                        "minLength": 2
                    },
                    "license": {
                        "type": "string",
                        "minLength": 2
                    },
                    "params_billion": {
                        "type": [
                            "number",
                            "null"
                        ]
                    },
                    "min_vram_gb": {
                        "type": "number",
                        "minimum": 1
                    },
                    "notes": {
                        "type": "string",
                        "minLength": 5
                    }
                }
            }
        },
        "k8s_components": {
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                    "category",
                    "primary",
                    "alternatives",
                    "why"
                ],
                "properties": {
                    "category": {
                        "type": "string",
                        "minLength": 2
                    },
                    "primary": {
                        "type": "string",
                        "minLength": 2
                    },
                    "alternatives": {
                        "type": "array",
                        "minItems": 1,
                        "items": {
                            "type": "string"
                        }
                    },
                    "why": {
                        "type": "string",
                        "minLength": 10
                    }
                }
            }
        },
        "architecture_diagram_mermaid": {
            "type": "string"
        },
        "deployment_plan": {
            "type": "array",
            "items": {
                "type": "string"
            }
        },
        "cost_estimate": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "method",
                "rough_range_usd"
            ],
            "properties": {
                "method": {
                    "type": "string",
                    "minLength": 5
                },
                "rough_range_usd": {
                    "type": "string",
                    "minLength": 3
                }
            }
        }
    },
    "allOf": [
        {
            "if": {
                "properties": {
                    "ready_to_answer": {
                        "const": false
                    }
                }
            },
            "then": {
                "properties": {
                    "blocked_reason": {
                        "type": "string",
                        "minLength": 5
                    },
                    "gpu_recommendations": {
                        "maxItems": 0
                    },
                    "model_recommendations": {
                        "maxItems": 0
                    },
                    "k8s_components": {
                        "maxItems": 0
                    },
                    "deployment_plan": {
                        "maxItems": 0
                    },
                    "architecture_diagram_mermaid": {
                        "maxLength": 0
                    }
                }
            }
        },
        {
            "if": {
                "properties": {
                    "ready_to_answer": {
                        "const": true
                    }
                }
            },
            "then": {
                "properties": {
                    "blocked_reason": {
                        "const": null
                    },
                    "gpu_recommendations": {
                        "minItems": 1
                    },
                    "model_recommendations": {
                        "minItems": 1
                    },
                    "k8s_components": {
                        "minItems": 1
                    },
                    "deployment_plan": {
                        "minItems": 4
                    },
                    "architecture_diagram_mermaid": {
                        "minLength": 20
                    }
                }
            }
        }
    ]
}